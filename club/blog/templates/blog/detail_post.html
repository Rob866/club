{% extends 'app/base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}

<section class="ftco-counter img ftco-section ftco-no-pt ftco-no-pb">
  <div class="container" style="margin-top:100px">
    		<div class="row d-flex">
<article class="media content-section">
        <div class="media-body">
            <div class="article-metadata">
                Creado por: <a class="mr-2" href="#">{{ post.autor}}</a>
                <small class="text-muted">{{ post.create_on }} Hrs</small>
            </div>
            <h3>{{ post.titulo }}</h3>

            {% if post.imagen %}
                     <img src="{{ post.imagen.url }}" class="img-fluid" alt="Responsive image"
                        style="margin-bottom : 10px">
            {% endif %}

            <p class="article-content">{{post.content}}</p>
             <a class="btn btn-outline-info mb-4" href="{% url 'blog:blog' %}">ir a Blog</a>
        </div>
  </article>
  </div>
  <!-- Comments Form -->
  <h2>Sistema de comentarios</h2>
  <div class="container">
            <div class="row justify-content-center">
            <div class="col-12 col-md-8">
              <form id="box" method="post" style="display:none; margin-bottom: 20px;">
                  {{ comment_form | crispy }}
                  {% csrf_token %}
                  <button  class="btn btn-outline-info mb-4" type="submit">enviar</button>
              </form>
            </div>
</div>
</div>

  <button id="togle" class="btn btn-outline-info mb-4"onclick="myFunction()" type="button" name="button">agregar comentario</button>

  <!-- Comment with nested comments -->
  {% for comment in comentarios %}
      <div class="comment" style="margin-bottom: 20px">
          <p class="info">{{ comment.nombre }} | {{ comment.created_on }}</p>
              {{ comment.body|linebreaks }}

            <ul class="list-group">
          {% for replay in comment.replies.all %}
             <li class="list-group-item" >
              <p class="info">{{ replay.nombre }} | {{ replay.created_on }}</p>
              <p>{{ replay.body }}</p>
              </li>
          {% endfor %}
          </ul>

        <h3>Contestar:</h3>
        <div class="container">
                  <div class="row justify-content-center">
                  <div class="col-12 col-md-8">
                    <form method="POST" style="padding:10px;">
                        {{ comment_form | crispy }}
                        {% csrf_token %}
                        <!-- Hidden input for parent comment.id -->
                        <input type="hidden" name="parent_id" value="{{ comment.id }}">
                        <input class="btn btn-outline-info mb-4"  type="submit" value="Replay">
                    </form>
       </div>
     </div>
   </div>
      </div>
  {% empty %}
  <h4>There are no comments yet.</h4>
  {% endfor %}

</div>

</section>
{%endblock content%}
